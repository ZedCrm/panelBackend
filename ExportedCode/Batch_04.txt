===== FILE: Domain\Objects\Shop\InvTran.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Domain.Objects.Shop
{
    public class InvTran : BaseDomain
    {
        
        public DateTime CreateTime { get; set; }
        public DateTime AcceptTime{ get; set; }
        public Inv Inv { get; set; }

    }
}


===== FILE: Domain\Objects\Shop\InvTranDetail.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Domain.Objects.Shop
{
    public class InvTranDetail : BaseDomain
    {
        public InvTran InvTran { get; set; }

    }
}


===== FILE: Domain\Objects\Shop\Product.cs =====
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations.Schema;
using System.Linq;
using System.Numerics;
using System.Text;
using System.Threading.Tasks;

namespace Domain.Objects.Shop
{
    public class Product : BaseDomain
    {
        public string? ProductCode { get; set; }
        public string Name { get; set; } = default!;
        public int Price { get; set; }
        public int CountTypeId { get; set; }
        public CountType CountType { get; set; }
    }
}


===== FILE: Domain\Objects\BaseDomain.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Domain.Objects
{
    public class BaseDomain
    {
        public int Id { get; set; }
        public DateTime CreateDate { get; set; }
        public DateTime? UpdateDate { get; set; }
        public bool IsDeleted { get; set; }=false;

    }
}


===== FILE: Infrastructure\data\seed\PermissionSeeder.cs =====
// Infrastructure/data/seed/PermissionSeeder.cs
using App.Contracts.Object.Base.auth;
using ConfApp;
using Domain.Objects.Base;
using Microsoft.EntityFrameworkCore;

namespace Infrastructure.data.seed
{
    public class PermissionSeeder
    {
        private readonly MyContext _context;
        private readonly IPermissionDiscoveryService _permissionDiscovery;

        public PermissionSeeder(MyContext context, IPermissionDiscoveryService permissionDiscovery)
        {
            _context = context;
            _permissionDiscovery = permissionDiscovery;
        }

        public async Task SeedAsync()
        {
            var permissionNames = _permissionDiscovery.GetAllPermissionNames();

            foreach (var name in permissionNames)
            {
                if (!await _context.Permissions.AnyAsync(p => p.Name == name && !p.IsDeleted))
                {
                    _context.Permissions.Add(new Permission
                    {
                        Name = name,
                        Category = 1,
                        CreateDate = DateTime.Now
                    });
                }
            }

            await _context.SaveChangesAsync();
        }
    }
}

===== FILE: Infrastructure\data\seed\UserSeeder.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using ConfApp;
using Domain.Objects.Base;

namespace Infrastructure.data.seed
{
    // UserSeeder.cs
public class UserSeeder
{
    private readonly MyContext _context;

    public UserSeeder(MyContext context)
    {
        _context = context;
    }

    public void Seed()
    {
        if (!_context.Users.Any(u => u.Email == "test@example.com"))
        {
            var user = new User
            {
                FullName = "Test User",
                Email = "test@example.com",
                PasswordHash = BCrypt.Net.BCrypt.HashPassword("123"),
                Status = UserStatus.Offline,
                Username = "test"
            };
            _context.Users.Add(user);
            _context.SaveChanges();
        }
    }
}

// RoleSeeder.cs (Ù…Ø«Ø§Ù„ Ø¯ÛŒÚ¯Ù‡)
public class RoleSeeder
{
    private readonly MyContext _context;

    public RoleSeeder(MyContext context)
    {
        _context = context;
    }

    public void Seed()
    {
        if (!_context.Roles.Any())
        {
            _context.Roles.AddRange(new List<Role>
            {
                new Role { Name = "Admin" },
                new Role { Name = "User" }
            });
            _context.SaveChanges();
        }
    }
 }

// DatabaseSeeder.cs
public class DatabaseSeeder
{
    private readonly MyContext _context;

    public DatabaseSeeder(MyContext context)
    {
        _context = context;
    }

    public void SeedAll()
    {
        new UserSeeder(_context).Seed();
         new RoleSeeder(_context).Seed();
        // Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒØªÙˆÙ†ÛŒ Seeder Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ù‡ Ù‡Ù… Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒ
    }
}

}

===== FILE: Infrastructure\Migrations\20251107184623_init.cs =====
using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace Infrastructure.Migrations
{
    /// <inheritdoc />
    public partial class init : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.CreateTable(
                name: "CountTypes",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Name = table.Column<string>(type: "nvarchar(50)", maxLength: 50, nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_CountTypes", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Inventories",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Name = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Active = table.Column<bool>(type: "bit", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Inventories", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Permissions",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Category = table.Column<int>(type: "int", nullable: false),
                    Name = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Permissions", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Persons",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Name = table.Column<string>(type: "nvarchar(250)", maxLength: 250, nullable: false),
                    Family = table.Column<string>(type: "nvarchar(250)", maxLength: 250, nullable: false),
                    Age = table.Column<int>(type: "int", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Persons", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Roles",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Name = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Roles", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Users",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    FullName = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Username = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Email = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    PasswordHash = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    ProfilePictureUrl = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    Status = table.Column<int>(type: "int", nullable: false),
                    LastSeen = table.Column<DateTime>(type: "datetime2", nullable: true),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Users", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Products",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    ProductCode = table.Column<string>(type: "nvarchar(max)", nullable: true),
                    Name = table.Column<string>(type: "nvarchar(250)", maxLength: 250, nullable: false),
                    Price = table.Column<int>(type: "int", nullable: false),
                    CountTypeId = table.Column<int>(type: "int", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Products", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Products_CountTypes_CountTypeId",
                        column: x => x.CountTypeId,
                        principalTable: "CountTypes",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "RolePermissions",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    RoleId = table.Column<int>(type: "int", nullable: false),
                    PermissionId = table.Column<int>(type: "int", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_RolePermissions", x => x.Id);
                    table.ForeignKey(
                        name: "FK_RolePermissions_Permissions_PermissionId",
                        column: x => x.PermissionId,
                        principalTable: "Permissions",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_RolePermissions_Roles_RoleId",
                        column: x => x.RoleId,
                        principalTable: "Roles",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "UserRoles",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    UserId = table.Column<int>(type: "int", nullable: false),
                    RoleId = table.Column<int>(type: "int", nullable: false),
                    CreateDate = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UpdateDate = table.Column<DateTime>(type: "datetime2", nullable: true),
                    IsDeleted = table.Column<bool>(type: "bit", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_UserRoles", x => x.Id);
                    table.ForeignKey(
                        name: "FK_UserRoles_Roles_RoleId",
                        column: x => x.RoleId,
                        principalTable: "Roles",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_UserRoles_Users_UserId",
                        column: x => x.UserId,
                        principalTable: "Users",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateIndex(
                name: "IX_CountTypes_Id",
                table: "CountTypes",
                column: "Id");

            migrationBuilder.CreateIndex(
                name: "IX_Persons_Id",
                table: "Persons",
                column: "Id");

            migrationBuilder.CreateIndex(
                name: "IX_Products_CountTypeId",
                table: "Products",
                column: "CountTypeId");

            migrationBuilder.CreateIndex(
                name: "IX_Products_Id",
                table: "Products",
                column: "Id");

            migrationBuilder.CreateIndex(
                name: "IX_RolePermissions_PermissionId",
                table: "RolePermissions",
                column: "PermissionId");

            migrationBuilder.CreateIndex(
                name: "IX_RolePermissions_RoleId",
                table: "RolePermissions",
                column: "RoleId");

            migrationBuilder.CreateIndex(
                name: "IX_UserRoles_RoleId",
                table: "UserRoles",
                column: "RoleId");

            migrationBuilder.CreateIndex(
                name: "IX_UserRoles_UserId",
                table: "UserRoles",
                column: "UserId");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "Inventories");

            migrationBuilder.DropTable(
                name: "Persons");

            migrationBuilder.DropTable(
                name: "Products");

            migrationBuilder.DropTable(
                name: "RolePermissions");

            migrationBuilder.DropTable(
                name: "UserRoles");

            migrationBuilder.DropTable(
                name: "CountTypes");

            migrationBuilder.DropTable(
                name: "Permissions");

            migrationBuilder.DropTable(
                name: "Roles");

            migrationBuilder.DropTable(
                name: "Users");
        }
    }
}


===== FILE: Infrastructure\Migrations\20251107184623_init.Designer.cs =====
// <auto-generated />
using System;
using ConfApp;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace Infrastructure.Migrations
{
    [DbContext(typeof(MyContext))]
    [Migration("20251107184623_init")]
    partial class init
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.10")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("Domain.Objects.Base.Permission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Category")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.ToTable("Permissions");
                });

            modelBuilder.Entity("Domain.Objects.Base.Person", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Age")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("Family")
                        .IsRequired()
                        .HasMaxLength(250)
                        .HasColumnType("nvarchar(250)");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(250)
                        .HasColumnType("nvarchar(250)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("Id");

                    b.ToTable("Persons", (string)null);
                });

            modelBuilder.Entity("Domain.Objects.Base.Role", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.ToTable("Roles");
                });

            modelBuilder.Entity("Domain.Objects.Base.RolePermission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<int>("PermissionId")
                        .HasColumnType("int");

                    b.Property<int>("RoleId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("PermissionId");

                    b.HasIndex("RoleId");

                    b.ToTable("RolePermissions");
                });

            modelBuilder.Entity("Domain.Objects.Base.User", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("FullName")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastSeen")
                        .HasColumnType("datetime2");

                    b.Property<string>("PasswordHash")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("ProfilePictureUrl")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.ToTable("Users");
                });

            modelBuilder.Entity("Domain.Objects.Base.UserRole", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<int>("RoleId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("RoleId");

                    b.HasIndex("UserId");

                    b.ToTable("UserRoles");
                });

            modelBuilder.Entity("Domain.Objects.Shop.CountType", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("Id");

                    b.ToTable("CountTypes", (string)null);
                });

            modelBuilder.Entity("Domain.Objects.Shop.Inv", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("Active")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.ToTable("Inventories");
                });

            modelBuilder.Entity("Domain.Objects.Shop.Product", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("CountTypeId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(250)
                        .HasColumnType("nvarchar(250)");

                    b.Property<int>("Price")
                        .HasColumnType("int");

                    b.Property<string>("ProductCode")
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CountTypeId");

                    b.HasIndex("Id");

                    b.ToTable("Products", (string)null);
                });

            modelBuilder.Entity("Domain.Objects.Base.RolePermission", b =>
                {
                    b.HasOne("Domain.Objects.Base.Permission", "Permission")
                        .WithMany("RolePermissions")
                        .HasForeignKey("PermissionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("Domain.Objects.Base.Role", "Role")
                        .WithMany("RolePermissions")
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Permission");

                    b.Navigation("Role");
                });

            modelBuilder.Entity("Domain.Objects.Base.UserRole", b =>
                {
                    b.HasOne("Domain.Objects.Base.Role", "Role")
                        .WithMany("UserRoles")
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("Domain.Objects.Base.User", "User")
                        .WithMany("UserRoles")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Role");

                    b.Navigation("User");
                });

            modelBuilder.Entity("Domain.Objects.Shop.Product", b =>
                {
                    b.HasOne("Domain.Objects.Shop.CountType", "CountType")
                        .WithMany("products")
                        .HasForeignKey("CountTypeId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("CountType");
                });

            modelBuilder.Entity("Domain.Objects.Base.Permission", b =>
                {
                    b.Navigation("RolePermissions");
                });

            modelBuilder.Entity("Domain.Objects.Base.Role", b =>
                {
                    b.Navigation("RolePermissions");

                    b.Navigation("UserRoles");
                });

            modelBuilder.Entity("Domain.Objects.Base.User", b =>
                {
                    b.Navigation("UserRoles");
                });

            modelBuilder.Entity("Domain.Objects.Shop.CountType", b =>
                {
                    b.Navigation("products");
                });
#pragma warning restore 612, 618
        }
    }
}


===== FILE: Infrastructure\Migrations\MyContextModelSnapshot.cs =====
// <auto-generated />
using System;
using ConfApp;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace Infrastructure.Migrations
{
    [DbContext(typeof(MyContext))]
    partial class MyContextModelSnapshot : ModelSnapshot
    {
        protected override void BuildModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.10")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("Domain.Objects.Base.Permission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Category")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.ToTable("Permissions");
                });

            modelBuilder.Entity("Domain.Objects.Base.Person", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("Age")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("Family")
                        .IsRequired()
                        .HasMaxLength(250)
                        .HasColumnType("nvarchar(250)");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(250)
                        .HasColumnType("nvarchar(250)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("Id");

                    b.ToTable("Persons", (string)null);
                });

            modelBuilder.Entity("Domain.Objects.Base.Role", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.ToTable("Roles");
                });

            modelBuilder.Entity("Domain.Objects.Base.RolePermission", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<int>("PermissionId")
                        .HasColumnType("int");

                    b.Property<int>("RoleId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("PermissionId");

                    b.HasIndex("RoleId");

                    b.ToTable("RolePermissions");
                });

            modelBuilder.Entity("Domain.Objects.Base.User", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("Email")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("FullName")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<DateTime?>("LastSeen")
                        .HasColumnType("datetime2");

                    b.Property<string>("PasswordHash")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("ProfilePictureUrl")
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("Status")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.ToTable("Users");
                });

            modelBuilder.Entity("Domain.Objects.Base.UserRole", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<int>("RoleId")
                        .HasColumnType("int");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.Property<int>("UserId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("RoleId");

                    b.HasIndex("UserId");

                    b.ToTable("UserRoles");
                });

            modelBuilder.Entity("Domain.Objects.Shop.CountType", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("nvarchar(50)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("Id");

                    b.ToTable("CountTypes", (string)null);
                });

            modelBuilder.Entity("Domain.Objects.Shop.Inv", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<bool>("Active")
                        .HasColumnType("bit");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.ToTable("Inventories");
                });

            modelBuilder.Entity("Domain.Objects.Shop.Product", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<int>("CountTypeId")
                        .HasColumnType("int");

                    b.Property<DateTime>("CreateDate")
                        .HasColumnType("datetime2");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("bit");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(250)
                        .HasColumnType("nvarchar(250)");

                    b.Property<int>("Price")
                        .HasColumnType("int");

                    b.Property<string>("ProductCode")
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime?>("UpdateDate")
                        .HasColumnType("datetime2");

                    b.HasKey("Id");

                    b.HasIndex("CountTypeId");

                    b.HasIndex("Id");

                    b.ToTable("Products", (string)null);
                });

            modelBuilder.Entity("Domain.Objects.Base.RolePermission", b =>
                {
                    b.HasOne("Domain.Objects.Base.Permission", "Permission")
                        .WithMany("RolePermissions")
                        .HasForeignKey("PermissionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("Domain.Objects.Base.Role", "Role")
                        .WithMany("RolePermissions")
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Permission");

                    b.Navigation("Role");
                });

            modelBuilder.Entity("Domain.Objects.Base.UserRole", b =>
                {
                    b.HasOne("Domain.Objects.Base.Role", "Role")
                        .WithMany("UserRoles")
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("Domain.Objects.Base.User", "User")
                        .WithMany("UserRoles")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Role");

                    b.Navigation("User");
                });

            modelBuilder.Entity("Domain.Objects.Shop.Product", b =>
                {
                    b.HasOne("Domain.Objects.Shop.CountType", "CountType")
                        .WithMany("products")
                        .HasForeignKey("CountTypeId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("CountType");
                });

            modelBuilder.Entity("Domain.Objects.Base.Permission", b =>
                {
                    b.Navigation("RolePermissions");
                });

            modelBuilder.Entity("Domain.Objects.Base.Role", b =>
                {
                    b.Navigation("RolePermissions");

                    b.Navigation("UserRoles");
                });

            modelBuilder.Entity("Domain.Objects.Base.User", b =>
                {
                    b.Navigation("UserRoles");
                });

            modelBuilder.Entity("Domain.Objects.Shop.CountType", b =>
                {
                    b.Navigation("products");
                });
#pragma warning restore 612, 618
        }
    }
}


===== FILE: Infrastructure\CRMBootstraper.cs =====
using App.Contracts.Object.Base;
using App.Contracts.Object.Base.auth;
using App.Contracts.Object.Base.auth.UserContext;
using App.Contracts.Object.Base.Users;
using App.Contracts.Object.Shop.CountTypeCon;
using App.Contracts.Object.Shop.InvCon;
using App.Contracts.Object.Shop.ProductCon;
using App.Object.Base;
using App.Object.Base.auth;
using App.Object.Base.auth.UserContext;
using App.Object.Base.Auth;
using App.Object.Base.Users;
using App.Object.Shop.CountTypeApp;
using App.Object.Shop.InvApp;
using App.Object.Shop.ProductApp;
using App.utility; // فقط IFileService
using ConfApp;
using ConfApp.Rep;
using ConfApp.Rep.bases;
using ConfApp.Rep.Inv;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.DependencyInjection;

namespace Infrastructure
{
    public static class CRMBootstraper
    {
        public static void AddCRMManagement(IServiceCollection services, string connectionString, DbProvider dbProvider)
        {


        
            // === Repository ها ===
            services.AddScoped<IPersonRep, PersonRep>();
            services.AddScoped<IProductRep, ProductRep>();
            services.AddScoped<ICountTypeRep, CountTypeRep>();
            services.AddScoped<IInvRep, InvRep>();
            services.AddScoped<IUserRepository, UserRep>();
            services.AddScoped<IPermissionRep, PermissionRepository>();
            services.AddScoped<IMyUserRepository, MyuserRepo>();
            services.AddScoped<IRoleRep, RoleRepo>();

            // === App Service ها ===
            services.AddScoped<IPersonApp, PersonApp>();
            services.AddScoped<IProductApp, ProductApp>();
            services.AddScoped<ICountTypeApp, CountTypeApp>();
            services.AddScoped<IInvApp, InvApp>();
            services.AddScoped<IAuthApp, AuthApp>();
            services.AddScoped<ITokenApp, TokenApp>();
            services.AddScoped<IPermissionService, PermissionService>();
            services.AddScoped<IUsersApp, UsersApp>();

            // === سرویس‌های مشترک ===
            services.AddSingleton<UserStatusService>();
            // IFileService فقط در Program.cs ثبت می‌شه

            // === HttpContextAccessor ===
            services.AddHttpContextAccessor();

            // === UserContext ===
            services.AddScoped<IUserContext, UserContext>();

            // === AutoMapper ===
            services.AddAutoMapper(typeof(ClassMapping));
            services.AddAutoMapper(AppDomain.CurrentDomain.GetAssemblies());

            // === DbContext ===
            services.AddDbContext<MyContext>(options =>
            {
                if (dbProvider == DbProvider.SqlServer)
                {
                    options.UseSqlServer(connectionString, b => b.MigrationsAssembly("Infrastructure"))
                           .EnableSensitiveDataLogging()
                           .LogTo(Console.WriteLine);
                }
                else if (dbProvider == DbProvider.Sqlite)
                {
                    options.UseSqlite(connectionString, b => b.MigrationsAssembly("Infrastructure"))
                           .EnableSensitiveDataLogging()
                           .LogTo(Console.WriteLine);
                }
            }, ServiceLifetime.Scoped);
        }
    }

    public enum DbProvider
    {
        SqlServer,
        Sqlite
    }
}

===== FILE: MyFrameWork\AppTool\ApiResult.cs =====
// MyFrameWork\AppTool\ApiResult.cs
using System;
using System.Collections.Generic;

namespace MyFrameWork.AppTool
{
    // Ù†Ø³Ø®Ù‡ ØºÛŒØ±Ú˜Ù†Ø±ÛŒÚ© (Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ ÛŒØ§ Ø®Ø·Ø§)
    public class ApiResult
    {
        public bool IsSucceeded { get; set; } = true;
        public int StatusCode { get; set; } = 200;
        public string? Message { get; set; }
        public List<string>? Errors { get; set; }

        // Ø¨Ø±Ø§ÛŒ ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
        public int? TotalRecords { get; set; }
        public int? TotalPages { get; set; }
        public int? PageNumber { get; set; }
        public int? PageSize { get; set; }

        // --- Factory Methods Ø¨Ø§ Ø¯ÛŒÙØ§Ù„Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ ---
        public static ApiResult Success(
            string? message = null,
            int? statusCode = null)
        {
            return new ApiResult
            {
                IsSucceeded = true,
                Message = message ?? MessageApp.AcceptOpt,
                StatusCode = statusCode ?? 200
            };
        }

        public static ApiResult Failed(
            string? error = null,
            int? statusCode = null,
            List<string>? errors = null)
        {
            return new ApiResult
            {
                IsSucceeded = false,
                Message = error ?? MessageApp.FailOpt,
                StatusCode = statusCode ?? 400,
                Errors = errors?.Count > 0 
                    ? errors 
                    : (string.IsNullOrWhiteSpace(error) 
                        ? new List<string> { MessageApp.FailOpt } 
                        : new List<string> { error })
            };
        }
    }

    // Ù†Ø³Ø®Ù‡ Ú˜Ù†Ø±ÛŒÚ© â€” **Ù‡Ù…Ù‡ Ø¬Ø§ Ø§Ø² Ø§ÛŒÙ† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…**
    public class ApiResult<T> : ApiResult
    {
        public T? Data { get; set; }

        // Success Ø¨Ø§ Ø¯Ø§Ø¯Ù‡
        public static ApiResult<T> Success(
            T data,
            string? message = null,
            int? statusCode = null)
        {
            return new ApiResult<T>
            {
                Data = data,
                IsSucceeded = true,
                Message = message ?? MessageApp.AcceptOpt,
                StatusCode = statusCode ?? 200
            };
        }

        // Paged Success
        public static ApiResult<T> PagedSuccess(
            T data,
            int totalRecords,
            int pageNumber,
            int pageSize,
            string? message = null,
            int? statusCode = null)
        {
            var totalPages = pageSize > 0 ? (int)Math.Ceiling(totalRecords / (double)pageSize) : 0;

            return new ApiResult<T>
            {
                Data = data,
                IsSucceeded = true,
                Message = message ?? MessageApp.AcceptOpt,
                StatusCode = statusCode ?? 200,
                TotalRecords = totalRecords,
                TotalPages = totalPages,
                PageNumber = pageNumber,
                PageSize = pageSize
            };
        }

        // Failed â€” Ø§Ø² Ù¾Ø§ÛŒÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ù‡
        public new static ApiResult<T> Failed(
            string? error = null,
            int? statusCode = null,
            List<string>? errors = null)
        {
            return new ApiResult<T>
            {
                IsSucceeded = false,
                Message = error ?? MessageApp.FailOpt,
                StatusCode = statusCode ?? 400,
                Errors = errors?.Count > 0 
                    ? errors 
                    : (string.IsNullOrWhiteSpace(error) 
                        ? new List<string> { MessageApp.FailOpt } 
                        : new List<string> { error })
            };
        }
    }
}

===== FILE: MyFrameWork\AppTool\MessageApp.cs =====
using System;

namespace MyFrameWork.AppTool
{
    public static class MessageApp
    {
        // ------------------------------
        // پیام‌های ثابت عمومی
        // ------------------------------
        public const string AcceptOpt = "عملیات با موفقیت انجام شد.";
        public const string FailOpt = "عملیات با خطا مواجه شد!!!";
        public const string NotPermission = "شما دسترسی لازم را ندارید.";
        public const string OperationCancelled = "عملیات لغو شد.";

        // پیام‌های خطا
        public const string ServerError = "خطای سرور رخ داده است. لطفاً بعداً تلاش کنید.";
        public const string ConnectionFailed = "اتصال به سرور برقرار نشد.";
        public const string Timeout = "زمان درخواست به پایان رسید.";
        public const string InvalidFormat = "فرمت ورودی صحیح نیست.";
        public const string InvalidInput = "ورودی وارد شده معتبر نیست.";

        // پیام‌های اعتبارسنجی
        public const string IsRequired = "این مقدار نمی‌تواند خالی باشد.";
        public const string MaxLength = "تعداد کاراکتر وارد شده بیشتر از حد مجاز است.";
        public const string MinLength = "تعداد کاراکتر وارد شده کمتر از حد مجاز است.";
        public const string NotFound = "مورد مورد نظر یافت نشد.";
        public const string DuplicateEntry = "این مقدار قبلاً ثبت شده است.";

        // ------------------------------
        // متدهای پویا برای پیام‌های قابل شخصی‌سازی
        // ------------------------------
        
        public static string RequiredField(string fieldName)
            => $"{fieldName} نمی‌تواند خالی باشد.";

        public static string MaxLengthExceeded(string fieldName, int maxLength)
            => $"تعداد کاراکترهای {fieldName} بیشتر از {maxLength} کاراکتر است.";

        public static string MinLengthNotMet(string fieldName, int minLength)
            => $"تعداد کاراکترهای {fieldName} کمتر از {minLength} کاراکتر است.";

        public static string NotFoundItem(string itemName)
            => $"{itemName} یافت نشد.";

        public static string DuplicateField(string fieldName)
            => $"{fieldName} قبلاً ثبت شده است.";

        public static string InvalidFieldInput(string fieldName)
            => $"مقدار وارد شده برای {fieldName} معتبر نیست.";

        public static string CustomError(string errorDetail)
            => $"خطا: {errorDetail}";

        public static string CustomSuccess(string action)
            => $"عملیات {action} با موفقیت انجام شد.";

        public static string CustomFail(string action)
            => $"عملیات {action} با خطا مواجه شد: {action}";
        

        public static string CustomDeleteFail(string action)
            => $". حذف با خطا مواجه شد: {action}";
        public static string CustomAddsuccses(string action)
            => $". رکورد با موفقیت ذخیره  شد: {action}";

        // ------------------------------
        // پیام‌های اطلاع‌رسانی
        // ------------------------------
        public const string InfoNoChanges = "هیچ تغییر جدیدی اعمال نشد.";
        public const string InfoSaved = "اطلاعات با موفقیت ذخیره شد.";
        public const string InfoDeleted = "مورد با موفقیت حذف شد.";
    
                // ------------------------------
        // پیام‌های اعتبارسنجی (DataAnnotation)
        // ------------------------------
        public const string IsRequiredcustom = "لطفاً {0} را وارد کنید.";
        public const string MaxLengthcustom = "تعداد کاراکترهای {0} نمی‌تواند بیشتر از {1} باشد.";
        public const string MinLengthcustom = "تعداد کاراکترهای {0} نمی‌تواند کمتر از {1} باشد.";
        public const string NotFoundcustom = "{0} یافت نشد.";
        public const string DuplicateEntrycustom = "{0} قبلاً ثبت شده است.";
        public const string InvalidInputcustom = "مقدار وارد شده برای {0} معتبر نیست.";
    
    
    
    
    
    }
}


===== FILE: MyFrameWork\AppTool\OPT.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MyFrameWork.AppTool
{
    public class OPT
    {
        public bool IsSucceeded { get; set; }
        public  string Message { get; set; }
        public OPT()
        {
            IsSucceeded = true;
        }

        public OPT Succeeded(string message = "عملیات با موفقیت انجام شد")
        {
            IsSucceeded = true;
            Message = message;
            return this;
        }
        public OPT Failed(string message)
        {
            IsSucceeded = false;
            Message = message;
            return this;
        }
    }
}


===== FILE: MyFrameWork\AppTool\OPTResult.cs =====
using System;
using System.Collections.Generic;

namespace MyFrameWork.AppTool
{
    public class OPTResult<T> where T : class
    {
        public bool IsSucceeded { get; set; }   // وضعیت موفقیت عملیات
        public string? Message { get; set; }     // پیام عملیات
        public List<T>? Data { get; set; }       // لیست داده‌ها برای حالت لیستی
        public T? SingleData { get; set; }       // داده‌ی تکی برای عملیات‌های خاص
        public int? TotalRecords { get; set; }   // مجموع رکوردها (در صفحه‌بندی)
        public int? TotalPages { get; set; }     // مجموع صفحات (در صفحه‌بندی)
        public int? PageNumber { get; set; }     // شماره صفحه جاری
        public int? PageSize { get; set; }       // تعداد آیتم در هر صفحه

        // متد سازنده پیش‌فرض
        public OPTResult()
        {
            IsSucceeded = true;
        }

        // ساخت نتیجه موفق برای لیست داده‌ها
        public static OPTResult<T> Success(List<T> data, string message = "عملیات با موفقیت انجام شد")
        {
            return new OPTResult<T>
            {
                IsSucceeded = true,
                Message = message,
                Data = data
            };
        }

        // ساخت نتیجه موفق برای یک داده تکی
        public static OPTResult<T> Success(T singleData, string message = "عملیات با موفقیت انجام شد")
        {
            return new OPTResult<T>
            {
                IsSucceeded = true,
                Message = message,
                SingleData = singleData
            };
        }


        // ساخت نتیجه موفق با پیام و بدون داده
        public static OPTResult<T> Success(string message = "عملیات با موفقیت انجام شد")
        {
            return new OPTResult<T>
            {
                IsSucceeded = true,
                Message = message
            };
        }





        // ساخت نتیجه ناموفق با پیام خطا
        public static OPTResult<T> Failed(string message = "عملیات با شکست مواجه شد")
        {
            return new OPTResult<T>
            {
                IsSucceeded = false,
                Message = message
            };
        }
    }
}


===== FILE: MyFrameWork\AppTool\Pagination.cs =====
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MyFrameWork.AppTool
{
    public class Pagination
    {
        [DefaultValue(1)]
        public int PageNumber { get; set; } = 1;
        [DefaultValue(3)]
        public int PageSize { get; set; } = 3;
        [DefaultValue("Id")]
        public string SortBy { get; set; } = "Id";
        public bool SortDirection { get; set; } = true;

        public int CalculateSkip()
        {
            return (PageNumber - 1) * PageSize; // محاسبه مقدار skip  
        }

        // متدی برای محاسبه تعداد کل صفحات با توجه به تعداد کل رکوردها  
        public int CalculateTotalPages(int totalRecords)
        {
            return (int)Math.Ceiling((double)totalRecords / PageSize); // محاسبه تعداد کل صفحات  
        }
    }
}


===== FILE: MyFrameWork\AppTool\PredicateBuilder.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using System.Text;
using System.Threading.Tasks;

namespace MyFrameWork.AppTool
{
    public static class PredicateBuilder
    {
        public static Expression<Func<T, bool>> And<T>(this Expression<Func<T, bool>> expr1, Expression<Func<T, bool>> expr2)
        {
            var parameter = Expression.Parameter(typeof(T));

            var combined = Expression.Invoke(expr1, parameter);
            var second = Expression.Invoke(expr2, parameter);
            var body = Expression.AndAlso(combined, second);

            return Expression.Lambda<Func<T, bool>>(body, parameter);
        }
    }
}


===== FILE: MyFrameWork\AppTool\SelectSourceAttribute.cs =====
using System;


namespace MyFrameWork.AppTool;
[AttributeUsage(AttributeTargets.Property)]
public class SelectSourceAttribute : Attribute
{
    public string SourceName { get; }

    public SelectSourceAttribute(string sourceName)
    {
        SourceName = sourceName;
    }
}


===== FILE: MyFrameWork\AppTool\Validator.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MyFrameWork.AppTool
{
    public static class Validators
    {

        public static void CheckRequired(string value, string fieldName)
        {
            if (string.IsNullOrWhiteSpace(value))
            {
                throw new ArgumentException($"مقدار {fieldName} اجباریست.");
            }
        }

        public static void CheckStringLength(string value, int minLength, int maxLength, string fieldName)
        {
            if (value.Length < minLength || value.Length > maxLength)
            {
                throw new ArgumentException($"مقدار کارکتر {fieldName} باید بین {minLength} و {maxLength} . باشد ");
            }
        }

       
    }
}


===== FILE: MyFrameWork\Class1.cs =====
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MyFrameWork
{
    internal class Class1
    {
    }
}


===== FILE: NuGet.config =====
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <clear />
    <add key="LocalPackages" value="E:\NugetPackages\" />
    <add key="nuget.org" value="https://api.nuget.org/v3/index.json" />
  </packageSources>
</configuration>

===== FILE: package-lock.json =====
{
  "name": "panelBackend",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {}
}


